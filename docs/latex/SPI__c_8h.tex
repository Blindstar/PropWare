\hypertarget{SPI__c_8h}{\section{\-S\-P\-I\-\_\-c.\-h \-File \-Reference}
\label{SPI__c_8h}\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}}
}
{\ttfamily \#include $<$propeller.\-h$>$}\*
{\ttfamily \#include $<$\-Prop\-Ware.\-h$>$}\*
\subsection*{\-Defines}
\begin{DoxyCompactItemize}
\item 
\hypertarget{SPI__c_8h_aaf2e0fe963841af076bea13ceee2f60a}{\#define {\bfseries \-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E}~1}\label{SPI__c_8h_aaf2e0fe963841af076bea13ceee2f60a}

\item 
\hypertarget{SPI__c_8h_ad7aa8b2172bf0f2d21947434125d8743}{\#define {\bfseries \-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-L\-I\-M\-I\-T}~16}\label{SPI__c_8h_ad7aa8b2172bf0f2d21947434125d8743}

\item 
\hypertarget{SPI__c_8h_a9c0ccae181686d893639ed80b47d8fce}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-P\-I\-N}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 0}\label{SPI__c_8h_a9c0ccae181686d893639ed80b47d8fce}

\item 
\hypertarget{SPI__c_8h_ae26a37559915a6b16eae9011b693925a}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-C\-L\-O\-C\-K\-\_\-\-I\-N\-I\-T}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 1}\label{SPI__c_8h_ae26a37559915a6b16eae9011b693925a}

\item 
\hypertarget{SPI__c_8h_adee07ee84205c8a33c32aa7d537bb7f1}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-M\-O\-D\-E}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 2}\label{SPI__c_8h_adee07ee84205c8a33c32aa7d537bb7f1}

\item 
\hypertarget{SPI__c_8h_ab04c6e32b6396692ec90d8a0f21fd570}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-P\-I\-N\-\_\-\-M\-A\-S\-K}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 3}\label{SPI__c_8h_ab04c6e32b6396692ec90d8a0f21fd570}

\item 
\hypertarget{SPI__c_8h_adfcc1a85b2f83b47c210bac0ecc3b17f}{\#define {\bfseries \-S\-P\-I\-\_\-\-T\-O\-O\-\_\-\-M\-A\-N\-Y\-\_\-\-B\-I\-T\-S}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 4}\label{SPI__c_8h_adfcc1a85b2f83b47c210bac0ecc3b17f}

\item 
\hypertarget{SPI__c_8h_a0131f2774f4e3dd71567400683b60405}{\#define {\bfseries \-S\-P\-I\-\_\-\-T\-I\-M\-E\-O\-U\-T}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 5}\label{SPI__c_8h_a0131f2774f4e3dd71567400683b60405}

\item 
\hypertarget{SPI__c_8h_a2c961ac14092949c9203f487ddabc8b7}{\#define {\bfseries \-S\-P\-I\-\_\-\-T\-I\-M\-E\-O\-U\-T\-\_\-\-R\-D}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 6}\label{SPI__c_8h_a2c961ac14092949c9203f487ddabc8b7}

\item 
\hypertarget{SPI__c_8h_a1e2bd4a2c458133a8bb504e8fd634aa8}{\#define {\bfseries \-S\-P\-I\-\_\-\-E\-X\-C\-E\-S\-S\-I\-V\-E\-\_\-\-P\-A\-R\-\_\-\-S\-Z}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 7}\label{SPI__c_8h_a1e2bd4a2c458133a8bb504e8fd634aa8}

\item 
\hypertarget{SPI__c_8h_a77089ed741166c75895bbe2ac0d735c1}{\#define {\bfseries \-S\-P\-I\-\_\-\-C\-O\-G\-\_\-\-N\-O\-T\-\_\-\-S\-T\-A\-R\-T\-E\-D}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 8}\label{SPI__c_8h_a77089ed741166c75895bbe2ac0d735c1}

\item 
\hypertarget{SPI__c_8h_ac740d3c2f0305ecee450bbc4c8eb4ece}{\#define {\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-U\-L\-E\-\_\-\-N\-O\-T\-\_\-\-R\-U\-N\-N\-I\-N\-G}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 9}\label{SPI__c_8h_ac740d3c2f0305ecee450bbc4c8eb4ece}

\item 
\hypertarget{SPI__c_8h_a7f658c92ee8ce9b1c3edb29f9adb2f7e}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-F\-R\-E\-Q}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 10}\label{SPI__c_8h_a7f658c92ee8ce9b1c3edb29f9adb2f7e}

\item 
\hypertarget{SPI__c_8h_a2084fa9f102bed6ca82ce27e43ff9aea}{\#define {\bfseries \-S\-P\-I\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-B\-Y\-T\-E\-\_\-\-S\-I\-Z\-E}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 11}\label{SPI__c_8h_a2084fa9f102bed6ca82ce27e43ff9aea}

\item 
\hypertarget{SPI__c_8h_a2516fde2d9190502d359bff011494eb6}{\#define {\bfseries \-S\-P\-I\-\_\-\-A\-D\-D\-R\-\_\-\-M\-I\-S\-A\-L\-I\-G\-N}~\-S\-P\-I\-\_\-\-E\-R\-R\-O\-R\-S\-\_\-\-B\-A\-S\-E + 12}\label{SPI__c_8h_a2516fde2d9190502d359bff011494eb6}

\end{DoxyCompactItemize}
\subsection*{\-Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{SPI__c_8h_a9a007893b26e98095afd1e6dc16b2354}{spimode\-\_\-t} \{ \*
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-0}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-1}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-2}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-3}, 
\*
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-S}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-0}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-1}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-2}, 
\*
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-3}, 
{\bfseries \-S\-P\-I\-\_\-\-M\-O\-D\-E\-S}
 \}
\begin{DoxyCompactList}\small\item\em \-Descriptor for \-S\-P\-I signal as defined by \-Motorola modes. \end{DoxyCompactList}\item 
enum \hyperlink{SPI__c_8h_adb031b048513c82ad2714a30989813cb}{spibitmode\-\_\-t} \{ \*
{\bfseries \-S\-P\-I\-\_\-\-L\-S\-B\-\_\-\-F\-I\-R\-S\-T} =  \-S\-P\-I\-\_\-\-M\-O\-D\-E\-S, 
{\bfseries \-S\-P\-I\-\_\-\-M\-S\-B\-\_\-\-F\-I\-R\-S\-T}, 
{\bfseries \-S\-P\-I\-\_\-\-B\-I\-T\-\_\-\-M\-O\-D\-E\-S}, 
{\bfseries \-S\-P\-I\-\_\-\-L\-S\-B\-\_\-\-F\-I\-R\-S\-T} =  \-S\-P\-I\-\_\-\-M\-O\-D\-E\-S, 
\*
{\bfseries \-S\-P\-I\-\_\-\-M\-S\-B\-\_\-\-F\-I\-R\-S\-T}, 
{\bfseries \-S\-P\-I\-\_\-\-B\-I\-T\-\_\-\-M\-O\-D\-E\-S}
 \}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
uint8\-\_\-t \hyperlink{SPI__c_8h_ae4ef02ff9049b9a16d01d12831fa166f}{\-S\-P\-I\-Start} (const uint32\-\_\-t mosi, const uint32\-\_\-t miso, const uint32\-\_\-t sclk, const uint32\-\_\-t frequency, const \hyperlink{spi_8h_a9a007893b26e98095afd1e6dc16b2354}{spimode\-\_\-t} mode, const \hyperlink{spi_8h_adb031b048513c82ad2714a30989813cb}{spibitmode\-\_\-t} bitmode)
\begin{DoxyCompactList}\small\item\em \-Initialize an \-S\-P\-I module by starting a new cog. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{SPI__c_8h_a915c655cc322998c4f1272a4abf25830}{\-S\-P\-I\-Is\-Running} (void)
\begin{DoxyCompactList}\small\item\em \-Determine if the \-S\-P\-I cog has already been initialized. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{SPI__c_8h_afbbabf86fc1531894472e7e3b2732996}{\-S\-P\-I\-Shift\-Out} (const uint8\-\_\-t bits, uint32\-\_\-t value)
\begin{DoxyCompactList}\small\item\em \-Send a value out to a peripheral device. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{SPI__c_8h_a4d54a10d5d52ff9ebda8419061be1518}{\-S\-P\-I\-Shift\-In} (uint8\-\_\-t bits, void $\ast$data, const size\-\_\-t size)
\begin{DoxyCompactList}\small\item\em \-Receive a value in from a peripheral device. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{SPI__c_8h_a8415a6a88c021f6750f8e3917c022c5d}{\-S\-P\-I\-Set\-Clock} (const uint32\-\_\-t frequency)
\begin{DoxyCompactList}\small\item\em \-Change the \-S\-P\-I module's clock frequency. \end{DoxyCompactList}\item 
\hypertarget{SPI__c_8h_a306d48ceb75797c8181606970c303645}{uint8\-\_\-t {\bfseries \-S\-P\-I\-Set\-Mode} (const \hyperlink{spi_8h_a9a007893b26e98095afd1e6dc16b2354}{spimode\-\_\-t} mode)}\label{SPI__c_8h_a306d48ceb75797c8181606970c303645}

\item 
\hypertarget{SPI__c_8h_a4021d898159ad0429fb1895af5e29610}{uint8\-\_\-t {\bfseries \-S\-P\-I\-Set\-Bit\-Mode} (const \hyperlink{spi_8h_adb031b048513c82ad2714a30989813cb}{spibitmode\-\_\-t} bitmode)}\label{SPI__c_8h_a4021d898159ad0429fb1895af5e29610}

\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\begin{DoxyAuthor}{\-Author}
\-Collin \-Winans
\end{DoxyAuthor}
\-S\-P\-I routine for \-Parallax \-Propeller. \-Runs in master mode only 

\subsection{\-Enumeration \-Type \-Documentation}
\hypertarget{SPI__c_8h_adb031b048513c82ad2714a30989813cb}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!spibitmode\-\_\-t@{spibitmode\-\_\-t}}
\index{spibitmode\-\_\-t@{spibitmode\-\_\-t}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{spibitmode\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf spibitmode\-\_\-t}}}\label{SPI__c_8h_adb031b048513c82ad2714a30989813cb}
\begin{DoxyNote}{\-Note}
\-Values starting at the end of \-S\-P\-I\-\_\-\-M\-O\-D\-E\-\_\-$\ast$ so that the values can be easily distinguished 
\end{DoxyNote}
\hypertarget{SPI__c_8h_a9a007893b26e98095afd1e6dc16b2354}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!spimode\-\_\-t@{spimode\-\_\-t}}
\index{spimode\-\_\-t@{spimode\-\_\-t}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{spimode\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf spimode\-\_\-t}}}\label{SPI__c_8h_a9a007893b26e98095afd1e6dc16b2354}


\-Descriptor for \-S\-P\-I signal as defined by \-Motorola modes. 

\-C\-P\-O\-L 0 refers to a low polarity (where the clock begins and ends in the low state) and \-C\-P\-O\-L 1 is for high polarity. \-T\-O\-D\-O\-: \-Describe phase

\-S\-P\-I mode \-C\-P\-O\-L \-C\-P\-H\-A 0 0 0 1 0 1 2 1 0 3 1 1 

\subsection{\-Function \-Documentation}
\hypertarget{SPI__c_8h_a915c655cc322998c4f1272a4abf25830}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!\-S\-P\-I\-Is\-Running@{\-S\-P\-I\-Is\-Running}}
\index{\-S\-P\-I\-Is\-Running@{\-S\-P\-I\-Is\-Running}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{\-S\-P\-I\-Is\-Running}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t {\bf \-S\-P\-I\-Is\-Running} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{SPI__c_8h_a915c655cc322998c4f1272a4abf25830}


\-Determine if the \-S\-P\-I cog has already been initialized. 

\begin{DoxyReturn}{\-Returns}
\-Returns 1 if the \-S\-P\-I cog is up and running, 0 otherwise 
\end{DoxyReturn}
\hypertarget{SPI__c_8h_a8415a6a88c021f6750f8e3917c022c5d}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!\-S\-P\-I\-Set\-Clock@{\-S\-P\-I\-Set\-Clock}}
\index{\-S\-P\-I\-Set\-Clock@{\-S\-P\-I\-Set\-Clock}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{\-S\-P\-I\-Set\-Clock}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t {\bf \-S\-P\-I\-Set\-Clock} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{frequency}
\end{DoxyParamCaption}
)}}\label{SPI__c_8h_a8415a6a88c021f6750f8e3917c022c5d}


\-Change the \-S\-P\-I module's clock frequency. 


\begin{DoxyParams}{\-Parameters}
{\em frequency} & \-Frequency, in \-Hz, to run the \-S\-P\-I clock; \-Must be less than \-C\-L\-K\-F\-R\-E\-Q/4\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Returns 0 upon success, otherwise error code 
\end{DoxyReturn}
\hypertarget{SPI__c_8h_a4d54a10d5d52ff9ebda8419061be1518}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!\-S\-P\-I\-Shift\-In@{\-S\-P\-I\-Shift\-In}}
\index{\-S\-P\-I\-Shift\-In@{\-S\-P\-I\-Shift\-In}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{\-S\-P\-I\-Shift\-In}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t {\bf \-S\-P\-I\-Shift\-In} (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{bits, }
\item[{void $\ast$}]{data, }
\item[{const size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{SPI__c_8h_a4d54a10d5d52ff9ebda8419061be1518}


\-Receive a value in from a peripheral device. 


\begin{DoxyParams}{\-Parameters}
{\em bits} & \-Number of bits to be shifted in \\
\hline
{\em $\ast$data} & \-Received data will be stored at this address \\
\hline
{\em bytes} & \-Byte-\/width of the $\ast$data variable type; \-Must be one of 1, 2, or 4 (is $\ast$data a pointer to char, short or int?)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Returns 0 upon success, otherwise error code 
\end{DoxyReturn}
\hypertarget{SPI__c_8h_afbbabf86fc1531894472e7e3b2732996}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!\-S\-P\-I\-Shift\-Out@{\-S\-P\-I\-Shift\-Out}}
\index{\-S\-P\-I\-Shift\-Out@{\-S\-P\-I\-Shift\-Out}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{\-S\-P\-I\-Shift\-Out}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t {\bf \-S\-P\-I\-Shift\-Out} (
\begin{DoxyParamCaption}
\item[{const uint8\-\_\-t}]{bits, }
\item[{uint32\-\_\-t}]{value}
\end{DoxyParamCaption}
)}}\label{SPI__c_8h_afbbabf86fc1531894472e7e3b2732996}


\-Send a value out to a peripheral device. 

\-Pass a value and mode into the assembly cog to be sent to the peripheral; \-N\-O\-T\-E\-: this function is non-\/blocking and chip-\/select should not be set inactive immediately after the return (you should call \hyperlink{spi_8c_a7c28b5429b624322919ba48763fc763a}{\-S\-P\-I\-Wait()} before setting chip-\/select inactive)


\begin{DoxyParams}{\-Parameters}
{\em bits} & \-Number of bits to be shifted out \\
\hline
{\em value} & \-The value to be shifted out\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Returns 0 upon success, otherwise error code 
\end{DoxyReturn}
\hypertarget{SPI__c_8h_ae4ef02ff9049b9a16d01d12831fa166f}{\index{\-S\-P\-I\-\_\-c.\-h@{\-S\-P\-I\-\_\-c.\-h}!\-S\-P\-I\-Start@{\-S\-P\-I\-Start}}
\index{\-S\-P\-I\-Start@{\-S\-P\-I\-Start}!SPI_c.h@{\-S\-P\-I\-\_\-c.\-h}}
\subsubsection[{\-S\-P\-I\-Start}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t {\bf \-S\-P\-I\-Start} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{mosi, }
\item[{const uint32\-\_\-t}]{miso, }
\item[{const uint32\-\_\-t}]{sclk, }
\item[{const uint32\-\_\-t}]{frequency, }
\item[{const {\bf spimode\-\_\-t}}]{mode, }
\item[{const {\bf spibitmode\-\_\-t}}]{bitmode}
\end{DoxyParamCaption}
)}}\label{SPI__c_8h_ae4ef02ff9049b9a16d01d12831fa166f}


\-Initialize an \-S\-P\-I module by starting a new cog. 


\begin{DoxyParams}{\-Parameters}
{\em mosi} & \-Pin mask for \-M\-O\-S\-I \\
\hline
{\em miso} & \-Pin mask for \-M\-I\-S\-O \\
\hline
{\em sclk} & \-Pin mask for \-S\-C\-L\-K \\
\hline
{\em frequency} & \-Frequency, in \-Hz, to run the \-S\-P\-I clock; \-Must be less than \-C\-L\-K\-F\-R\-E\-Q/4 \\
\hline
{\em polarity} & \-Polarity of the clock -\/ idle low or high; must be one of \-S\-P\-I\-\_\-\-P\-O\-L\-A\-R\-I\-T\-Y\-\_\-\-L\-O\-W or \-S\-P\-I\-\_\-\-P\-O\-L\-A\-R\-I\-T\-Y\-\_\-\-H\-I\-G\-H\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Returns 0 upon success, otherwise error code 
\end{DoxyReturn}
